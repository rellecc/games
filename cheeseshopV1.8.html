<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cheese Shop Simulator</title>
    <style>
        body {
            font-family: 'Segoe UI', Arial, sans-serif;
            text-align: center;
            background: linear-gradient(to bottom, #fff8e1, #ffecb3);
            margin: 0;
            padding: 20px;
            color: #3e2723;
            min-height: 100vh;
        }
        h1 {
            font-size: 3em;
            color: #ff6f00;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
            margin-bottom: 10px;
        }
        h2, h3 {
            color: #d84315;
        }
        button {
            padding: 12px 24px;
            margin: 8px;
            font-size: 18px;
            cursor: pointer;
            border: none;
            border-radius: 12px;
            background-color: #ffab00;
            color: white;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
            transition: all 0.2s;
        }
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(0,0,0,0.3);
        }
        button:disabled {
            background-color: #9e9e9e;
            cursor: not-allowed;
            transform: none;
        }
        .back-btn {
            background-color: #e53935;
            position: fixed;
            bottom: 20px;
            left: 20px;
            z-index: 100;
        }
        .prestige-btn {
            background-color: #9c27b0;
            font-size: 1.4em;
            padding: 15px 30px;
        }
        .prestige-btn:hover {
            background-color: #7b1fa2;
        }
        .save-slot {
            margin: 20px;
            padding: 25px;
            border: 4px solid #ff6f00;
            border-radius: 20px;
            display: inline-block;
            width: 250px;
            background: #ffffff;
            box-shadow: 0 6px 15px rgba(0,0,0,0.15);
        }
        #money {
            font-size: 2.5em;
            margin: 30px;
            padding: 15px;
            background: #4caf50;
            color: white;
            border-radius: 15px;
            display: inline-block;
            box-shadow: 0 4px 10px rgba(0,0,0,0.2);
        }
        #prestige {
            font-size: 1.8em;
            margin: 20px;
            color: #9c27b0;
        }
        .container {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 30px;
            margin-top: 20px;
        }
        .panel {
            background: white;
            border-radius: 20px;
            padding: 20px;
            width: 420px;
            box-shadow: 0 8px 20px rgba(0,0,0,0.15);
        }
        .panel h3 {
            margin-top: 0;
            padding-bottom: 10px;
            border-bottom: 3px solid #ffab00;
            text-align: center;
        }
        .cheese-item {
            background: #fffde7;
            border: 2px solid #ffcc80;
            border-radius: 15px;
            padding: 15px;
            margin: 15px 0;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
        }
        .cheese-item strong {
            font-size: 1.3em;
            color: #bf360c;
        }
        .sell-btn {
            width: 100%;
            background: linear-gradient(to bottom, #66bb6a, #43a047);
            font-size: 1.2em;
            padding: 12px;
            margin-top: 10px;
        }
        .buy-btn {
            background: linear-gradient(to bottom, #ffa726, #ff8f00);
            padding: 10px 20px;
            font-weight: bold;
        }
        .empty-message {
            font-size: 1.2em;
            color: #999;
            padding: 40px;
        }
        .value-info {
            font-size: 1.1em;
            margin: 8px 0;
        }
    </style>
</head>
<body>
    <div id="titleScreen">
        <h1>Cheese Shop Simulator</h1>
        <p>Made By Corgii</p>
        <button onclick="showSaves()">Play</button>
    </div>

    <div id="saveScreen" style="display: none;">
        <h2>Select a Save File</h2>
        <div id="saves"></div>
        <br><br>
        <button onclick="backToTitle()">Back</button>
    </div>

    <div id="gameScreen" style="display: none;">
        <div id="money">Money: $0.00</div>
        <div id="prestige">Prestige Level: 0 (+0% bonus)</div>
        
        <div class="container">
            <div class="panel">
                <h3>Cheese Shop</h3>
                <div id="shop"></div>
            </div>
            
            <div class="panel">
                <h3>Inventory</h3>
                <div id="inventory"></div>
            </div>
        </div>

        <button class="prestige-btn" onclick="prestige()" id="prestigeButton" style="display:none;">
            Prestige (Reset for permanent bonus)
        </button>

        <button class="back-btn" onclick="backToTitleFromGame()">Back to Title</button>
    </div>

    <script>
        const cheeseNames = [
            'Bouhezza', 'Kemariya', 'Wagasi', 'Areesh', 'Baramily',
            'Domiati', 'Halumi', 'Istanbolly', 'Mish', 'Rumi',
            'Ayibe', 'Caravane cheese', 'Warankasi', 'Kwaito', 'Aragatsyan panir',
            'Chanakh', 'Chechil', 'Kanach panir', 'Lori', 'Motal',
            'Tel panir', 'Yeghegnadzor', 'Byaslag', 'Chura kampo', 'Chura loenpa',
            'Nguri', 'Rubing', 'Rushan', 'Imeruli', 'Sulguni',
            'Tenili', 'Bandel', 'Paneer', 'Khoa', 'Chhana',
            'Dahi Chhana', 'Kalari', 'Kalimpong cheese', 'Qudam', 'Dangke',
            'Sakura cheese', 'Imsil', 'Susu Masam', 'Flower of Rajya', 'Chhurpi',
            'Kesong puti', 'Djathë i bardhë', 'Kaçkavall', 'Djathë pice', 'Gjizë'
        ];

        // Perfectly balanced: each cheese produces exactly baseCost / 15 per second
        // Payback time ~15 seconds if held (reasonable for an idle game)
        const cheeses = cheeseNames.map((name, i) => {
            const baseCost = Math.round(15 * Math.pow(1.45, i)); // Smooth, satisfying growth
            return {
                name,
                baseCost,
                rate: Number((baseCost / 15).toFixed(2))  // Exactly 1/15th of cost per second
            };
        });

        const priceMultiplier = 1.15; // Repeated buys get 15% more expensive
        let gameData = null;
        let currentSave = null;
        let updateInterval = null;
        let autoSaveInterval = null;

        function initSaves() {
            const savesDiv = document.getElementById('saves');
            savesDiv.innerHTML = '';
            for (let i = 1; i <= 4; i++) {
                const key = 'save' + i;
                const raw = localStorage.getItem(key);
                let info = 'Empty Slot';
                if (raw) {
                    try {
                        const parsed = JSON.parse(raw);
                        info = `$${parsed.money.toFixed(2)} | Prestige ${parsed.prestige || 0}`;
                    } catch (e) {
                        info = 'Corrupted';
                    }
                }
                const slot = document.createElement('div');
                slot.className = 'save-slot';
                slot.innerHTML = `
                    <strong>Save Slot ${i}</strong><br><br>
                    ${info}<br><br>
                    <button onclick="loadSave('${key}')">Select</button>
                    <button onclick="deleteSave('${key}')">Delete</button>
                `;
                savesDiv.appendChild(slot);
            }
        }

        function showSaves() {
            document.getElementById('titleScreen').style.display = 'none';
            document.getElementById('saveScreen').style.display = 'block';
            initSaves();
        }

        function backToTitle() {
            document.getElementById('saveScreen').style.display = 'none';
            document.getElementById('titleScreen').style.display = 'block';
        }

        function backToTitleFromGame() {
            if (confirm('Leave the game? Progress is auto-saved.')) {
                clearInterval(updateInterval);
                clearInterval(autoSaveInterval);
                document.getElementById('gameScreen').style.display = 'none';
                document.getElementById('titleScreen').style.display = 'block';
            }
        }

        function loadSave(key) {
            const raw = localStorage.getItem(key);
            if (raw) {
                try {
                    gameData = JSON.parse(raw);
                } catch (e) {
                    alert('Save corrupted. Starting new game.');
                    gameData = initNewGame();
                }
            } else {
                gameData = initNewGame();
            }
            currentSave = key;
            startGame();
        }

        function initNewGame() {
            return {
                money: cheeses[0].baseCost, // Enough for the first cheese
                inventory: [],
                purchasedCounts: new Array(50).fill(0),
                prestige: 0,
                totalEarned: 0
            };
        }

        function deleteSave(key) {
            if (confirm('Delete this save?')) {
                localStorage.removeItem(key);
                initSaves();
            }
        }

        function startGame() {
            document.getElementById('saveScreen').style.display = 'none';
            document.getElementById('gameScreen').style.display = 'block';

            if (updateInterval) clearInterval(updateInterval);
            if (autoSaveInterval) clearInterval(autoSaveInterval);

            updateDisplay();
            updateInterval = setInterval(updateDisplay, 1000);
            autoSaveInterval = setInterval(saveGame, 5000);
        }

        function updateDisplay() {
            const bonus = gameData.prestige * 0.25; // +25% per prestige (stronger reward)
            document.getElementById('money').innerHTML = `Money: $${gameData.money.toFixed(2)}`;
            document.getElementById('prestige').innerHTML = `Prestige Level: ${gameData.prestige} (+${(bonus*100).toFixed(0)}% income bonus)`;

            const prestigeThreshold = 5000000; // 5 million lifetime to prestige
            if (gameData.totalEarned >= prestigeThreshold) {
                document.getElementById('prestigeButton').style.display = 'block';
                document.getElementById('prestigeButton').innerHTML = 
                    `Prestige!<br>Reset for +25% permanent income<br>(You have $${gameData.totalEarned.toLocaleString()} lifetime)`;
            } else {
                document.getElementById('prestigeButton').style.display = 'none';
            }

            updateShop();
            updateInventory();
        }

        function updateShop() {
            const shopDiv = document.getElementById('shop');
            shopDiv.innerHTML = '';

            cheeses.forEach((cheese, i) => {
                const count = gameData.purchasedCounts[i];
                const cost = Math.round(cheese.baseCost * Math.pow(priceMultiplier, count));
                const canBuy = gameData.money >= cost;

                const item = document.createElement('div');
                item.className = 'cheese-item';
                item.innerHTML = `
                    <strong>${cheese.name}</strong><br>
                    Cost: $${cost.toLocaleString()}<br>
                    +$${cheese.rate.toFixed(2)} per second<br>
                    <button class="buy-btn" onclick="buyCheese(${i})" ${canBuy ? '' : 'disabled'}>
                        Buy
                    </button>
                `;
                shopDiv.appendChild(item);
            });
        }

        function buyCheese(i) {
            const cheese = cheeses[i];
            const count = gameData.purchasedCounts[i];
            const cost = Math.round(cheese.baseCost * Math.pow(priceMultiplier, count));

            if (gameData.money >= cost) {
                gameData.money -= cost;
                gameData.inventory.push({
                    typeId: i,
                    purchaseTime: Date.now(),
                    baseValue: cost
                });
                gameData.purchasedCounts[i]++;
                updateDisplay();
                saveGame();
            }
        }

        function formatTime(seconds) {
            const days = Math.floor(seconds / 86400);
            const hours = Math.floor((seconds % 86400) / 3600);
            const minutes = Math.floor((seconds % 3600) / 60);
            const secs = Math.floor(seconds % 60);

            let str = '';
            if (days > 0) str += `${days}d `;
            if (hours > 0 || days > 0) str += `${hours}h `;
            if (minutes > 0 || hours > 0 || days > 0) str += `${minutes}m `;
            str += `${secs}s`;
            return str.trim();
        }

        function updateInventory() {
            const invDiv = document.getElementById('inventory');
            invDiv.innerHTML = '';

            if (gameData.inventory.length === 0) {
                invDiv.innerHTML = '<p class="empty-message">No cheeses maturing yet.<br>Go buy some!</p>';
                return;
            }

            const multiplier = 1 + gameData.prestige * 0.25;

            gameData.inventory.forEach((item, idx) => {
                const cheese = cheeses[item.typeId];
                const timeHeldSec = (Date.now() - item.purchaseTime) / 1000;
                const effectiveRate = cheese.rate * multiplier;
                const currentValue = item.baseValue + effectiveRate * timeHeldSec;
                const profit = effectiveRate * timeHeldSec;
                const age = formatTime(timeHeldSec);

                const itemDiv = document.createElement('div');
                itemDiv.className = 'cheese-item';
                itemDiv.innerHTML = `
                    <strong>${cheese.name}</strong><br>
                    Age: ${age}<br>
                    Base: $${item.baseValue.toLocaleString()}<br>
                    + Profit: $${profit.toFixed(2)}<br>
                    <strong>Current Value: $${currentValue.toFixed(2)}</strong><br>
                    <button class="sell-btn" onclick="sellCheese(${idx})">
                        Sell for $${currentValue.toFixed(2)}
                    </button>
                `;
                invDiv.appendChild(itemDiv);
            });
        }

        function sellCheese(idx) {
            const item = gameData.inventory[idx];
            const cheese = cheeses[item.typeId];
            const timeHeldSec = (Date.now() - item.purchaseTime) / 1000;
            const multiplier = 1 + gameData.prestige * 0.25;
            const value = item.baseValue + cheese.rate * multiplier * timeHeldSec;

            gameData.money += value;
            gameData.totalEarned += value;
            gameData.inventory.splice(idx, 1);
            updateDisplay();
            saveGame();
        }

        function prestige() {
            if (gameData.totalEarned < 5000000) return;

            if (confirm('PRESTIGE?\nReset money, inventory & purchases for +25% permanent income bonus?')) {
                gameData.prestige += 1;
                gameData.money = cheeses[0].baseCost;
                gameData.inventory = [];
                gameData.purchasedCounts = new Array(50).fill(0);
                updateDisplay();
                saveGame();
                alert('Prestiged! You now have +25% income forever!');
            }
        }

        function saveGame() {
            if (currentSave && gameData) {
                localStorage.setItem(currentSave, JSON.stringify(gameData));
            }
        }
    </script>
</body>
</html>
